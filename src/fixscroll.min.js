/**
 * FixScroll
 *
 * @version      0.2
 * @author       nori (norimania@gmail.com)
 * @copyright    5509 (http://5509.me/)
 * @license      The MIT License
 * @link         https://github.com/5509/fixscroll
 *
 * 2011-10-12 02:01
 */
;(function(i,j,e){i.FixScroll=h;var k=j.body,d=j.documentElement,a=(function(){var b=i.navigator.userAgent;return{msie:b.indexOf("MSIE")!==-1,version:(function(){if(b.match(/MSIE (\d\.\d)/)){return RegExp.$1;}}())};}());function h(o,m){var n,b=this;if(a.msie&&a.version<7){return;}if(b===i){return new h(o,m);}b.opts={parent:"body",top:0,bottom:0};b.elm=j.getElementById(o);b.id=o;b.state="unlocked";b.callback={};for(n in m){b.opts[n]=m[n];}b._init();}h.prototype={_init:function(){var b=this;b._getDefault();b._scroll();b._bind();},_getDefault:function(){var b=this,n,m=null;b.parent=b.opts.parent==="body"?j.body:j.getElementById(b.opts.parent);b.offsetHeight=b.elm.offsetHeight;b.parentHeight=b.parent.offsetHeight;if(i.getComputedStyle){n=getComputedStyle(k);parentCss=getComputedStyle(b.parent);}else{n=k.currentStyle;parentCss=b.parent.currentStyle;}m=(function(){var q=l(n["margin-top"]),p=l(n["margin-left"]),o=l(n["padding-top"]),r=l(n["padding-top"]);return{top:(q+o)||0,left:(p+r)||0};}());b.defaultPos={position:n.position,adjTop:m.top,adjLeft:m.left,ptPdgTop:l(parentCss["padding-top"]),ptPdgBtm:l(parentCss["padding-bottom"]),top:m.top+b.elm.offsetTop,left:m.left+b.elm.offsetLeft};},_setDefault:function(){var b=this;f(b.elm,{position:b.defaultPos.position,top:b.defaultPos.top+"px"});},_setFix:function(){var b=this;f(b.elm,{position:"fixed",top:b.opts.top+"px"});},_bottomFix:function(){var b=this;f(b.elm,{position:"absolute",top:b.bottomFix+"px"});},_bind:function(){var b=this;g(b.elm,b.id+".locked",function(){b._setFix();if(b.callback.locked){b.callback.locked();}});g(b.elm,b.id+".unlocked",function(){b._setDefault();if(b.callback.unlocked){b.callback.unlocked();}});g(b.elm,b.id+".bottomlocked",function(){b._bottomFix();if(b.callback.bottomlocked){b.callback.bottomlocked();}});},_scroll:function(){var b=this;g(i,"scroll",function(){var p=k.scrollTop||d.scrollTop,r=b.defaultPos,m=r.top-b.opts.top,q=m<0?0:m,n=p+b.offsetHeight,o=b.parentHeight+r.adjTop-r.ptPdgBtm;if(p>=q&&n<o){if(b.state==="locked"){return;}b.state="locked";c(b.elm,b.id+".locked");}else{if(n>=o){if(b.state==="bottomlocked"){return;}b.bottomFix=b.parentHeight-b.offsetHeight-r.ptPdgBtm;b.state="bottomlocked";c(b.elm,b.id+".bottomlocked");}else{if(b.state==="unlocked"){return;}b.state="unlocked";c(b.elm,b.id+".unlocked");}}});},bind:function(m,n){var b=this;switch(m){case".locked":b.callback.locked=n;break;case".bottomlocked":b.callback.bottomlocked=n;break;case".unlocked":b.callback.unlocked=n;}return b;}};function l(b){return parseInt(b,10);}function c(n,m){var b=e;if("createEvent" in j){b=j.createEvent("UIEvents");b.initEvent(m,false,true);n.dispatchEvent(b);}else{if("createEventObject" in j){b=j.createEventObject();b.name=m;n.fireEvent("ondataavailable",b);}}}function g(n,m,b){if(i.addEventListener){n.addEventListener(m,b,false);}else{if(!n[m]){n.attachEvent("ondataavailable",function(o){o.func=o.func||{};o.func[m]=b;if(!o.func[o.name]){return;}o.func[o.name]();o.name=null;});}else{n.attachEvent("on"+m,b);}}}function f(n,m){var b;for(b in m){n.style[b]=m[b];}}}(this,this.document));